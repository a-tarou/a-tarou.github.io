<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥³å„ªåé‘‘ï¼ˆå­¦ç¿’ã‚µã‚¤ãƒˆï¼‰</title>

<style>
/* CSSã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã“ã‹ã‚‰ */
body {
    font-family: Arial, sans-serif;
    margin: 20px;
    padding: 0;
    background-color: #f4f4f4;
}

.search-area {
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 20px;
}

.input-group {
    margin-bottom: 15px;
    /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’è¦‹ã‚„ã™ãã™ã‚‹ãŸã‚ã«ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦è¨­å®š */
    display: block; 
}

.input-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.input-group input[type="number"], .input-group select {
    padding: 8px;
    margin-right: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

/* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ãƒ©ãƒ™ãƒ«ã®é…ç½®ã‚’èª¿æ•´ */
#cup-checkboxes input[type="checkbox"], 
#cup-checkboxes label {
    margin-right: 15px; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹é–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
    display: inline-block;
}

#search-button {
    background-color: #007bff;
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

#search-button:hover {
    background-color: #0056b3;
}
</style>

</head>
<body>
    <h1>å¥³å„ªåé‘‘ã‚µã‚¤ãƒˆã¸ã‚ˆã†ã“ãï¼</h1>
    <p>ã“ã®ã‚µã‚¤ãƒˆã¯ã€APIã‚’åˆ©ç”¨ã—ãŸå¥³å„ªæ¤œç´¢æ©Ÿèƒ½ã®å­¦ç¿’ç”¨ã‚µã‚¤ãƒˆã§ã™ã€‚</p>
    
    <div class="search-area">
        <h2>å¥³å„ªæ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ </h2>
        
        <div class="input-group">
            <label for="age">å¹´é½¢:</label>
            <input type="number" id="age_min" placeholder="æœ€ä½å¹´é½¢" min="18" style="width: 80px;">
            <span>ã€œ</span>
            <input type="number" id="age_max" placeholder="æœ€é«˜å¹´é½¢" min="18" style="width: 80px;">
        </div>

        <div class="input-group">
            <label for="height">èº«é•· (cm):</label>
            <input type="number" id="height_min" placeholder="æœ€ä½èº«é•·" min="100" max="200" style="width: 80px;">
            <span>ã€œ</span>
            <input type="number" id="height_max" placeholder="æœ€é«˜èº«é•·" min="100" max="200" style="width: 80px;">
        </div>
        
        <div class="input-group">
            <label>ã‚«ãƒƒãƒ—æ•° (è¤‡æ•°é¸æŠå¯):</label>
            <div id="cup-checkboxes" style="display: flex; flex-wrap: wrap;">
                <input type="checkbox" id="cup_A" name="cup" value="A"><label for="cup_A">A</label>
                <input type="checkbox" id="cup_B" name="cup" value="B"><label for="cup_B">B</label>
                <input type="checkbox" id="cup_C" name="cup" value="C"><label for="cup_C">C</label>
                <input type="checkbox" id="cup_D" name="cup" value="D"><label for="cup_D">D</label>
                <input type="checkbox" id="cup_E" name="cup" value="E"><label for="cup_E">E</label>
                <input type="checkbox" id="cup_F" name="cup" value="F"><label for="cup_F">F</label>
                <input type="checkbox" id="cup_G" name="cup" value="G"><label for="cup_G">G</label>
                <input type="checkbox" id="cup_H" name="cup" value="H"><label for="cup_H">H</label>
                <input type="checkbox" id="cup_I" name="cup" value="I"><label for="cup_I">I</label>
                <input type="checkbox" id="cup_J" name="cup" value="J"><label for="cup_J">J</label>
                <input type="checkbox" id="cup_K" name="cup" value="K"><label for="cup_K">K</label>
                <input type="checkbox" id="cup_L" name="cup" value="L"><label for="cup_L">L</label>
                <input type="checkbox" id="cup_L_over" name="cup" value="Lä»¥ä¸Š"><label for="cup_L_over">Lä»¥ä¸Š</label>
            </div>
        </div>
        
        <div class="input-group">
            <label>ä½“å‹ (ç‹¬è‡ªã‚¿ã‚°):</label>
            <div id="bodytype-checkboxes" style="display: flex; flex-wrap: wrap;">
                <p style="font-size: 0.9em; color: #666;">â€»ã“ã“ã«ä½“å‹ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆæ‰¿èªå¾Œã«å®Ÿè£…ï¼‰</p>
            </div>
        </div>

        <div class="input-group">
            <label>ç³»çµ± (ç‹¬è‡ªã‚¿ã‚°):</label>
            <div id="genre-checkboxes" style="display: flex; flex-wrap: wrap;">
                <p style="font-size: 0.9em; color: #666;">â€»ã“ã“ã«ç³»çµ±ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆæ‰¿èªå¾Œã«å®Ÿè£…ï¼‰</p>
            </div>
        </div>
        
        <button id="search-button" onclick="fetchActressData()">æ¤œç´¢ã™ã‚‹</button>
    </div>

    <hr>

    <div class="actress-list">
        <h2>æ¤œç´¢çµæœ</h2>
        <p id="loading-message">ã“ã“ã«å¥³å„ªã•ã‚“ã®ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹äºˆå®šã§ã™ã€‚FANZAã®æ‰¿èªã‚’å¾…ã£ã¦ã„ã¾ã™...</p>
    </div>
    
    <script>
    // -----------------------------------------------------------
    // ç‹¬è‡ªã®æ¤œç´¢ã‚¿ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿ (è¦æœ›â‘¢, â‘£)
    // -----------------------------------------------------------
    const localActressData = [
        { name: "çŸ³å· æ¾ª", bodyType: "ã‚¹ãƒ¬ãƒ³ãƒ€ãƒ¼", genre: ["å¯æ„›ã„ç³»", "æ¸…æ¥šç³»"] },
        { name: "æ²³åŒ— å½©ä¼½ï¼ˆæ²³åŒ— å½©èŠ±ï¼‰", bodyType: "ã‚¹ãƒ¬ãƒ³ãƒ€ãƒ¼", genre: ["ç¾äººç³»", "æ¸…æ¥šç³»"] },
        { name: "ç€¬æˆ¸ ç’°å¥ˆ", bodyType: "ã‚°ãƒ©ãƒãƒ¼", genre: ["æ¸…æ¥šç³»", "å¯æ„›ã„ç³»"] },
    ];

    // -----------------------------------------------------------
    // æ¤œç´¢ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹é–¢æ•°
    // -----------------------------------------------------------
    function fetchActressData() {
        // ğŸš¨ æ‰¿èªå¾Œã€ã“ã“ã‚’ã‚ãªãŸã®ã‚­ãƒ¼ã«ç½®ãæ›ãˆã¾ã™ ğŸš¨
        const CLIENT_ID = "[ã‚ãªãŸã®Client ID]"; 
        const AFFILIATE_ID = "[ã‚ãªãŸã®Affiliate ID]";
        
        // æ¤œç´¢æ¡ä»¶ã®å–å¾—
        const heightMin = document.getElementById('height_min').value;
        const heightMax = document.getElementById('height_max').value;
        const ageMin = document.getElementById('age_min').value;
        const ageMax = document.getElementById('age_max').value;
        
        // è¤‡æ•°é¸æŠã•ã‚ŒãŸã‚«ãƒƒãƒ—æ•°ã‚’å–å¾—ã™ã‚‹å‡¦ç† (æ–°ã—ã„ãƒ­ã‚¸ãƒƒã‚¯)
        const checkedCups = Array.from(document.querySelectorAll('input[name="cup"]:checked'))
                                 .map(checkbox => checkbox.value);

        // FANZA APIã®åŸºæœ¬è¨­å®š
        const API_ENDPOINT = "https://api.dmm.com/affiliate/v3/ItemList";
        const keyParams = `api_id=${CLIENT_ID}&affiliate_id=${AFFILIATE_ID}`;
        
        // æ¤œç´¢æ¡ä»¶ã‚’çµ„ã¿ç«‹ã¦ã‚‹
        let searchParams = 'site=DMM.R18&service=digital&hits=50&sort=rank&keyword=å¥³å„ª';
        
        // 1. ã‚«ãƒƒãƒ—æ•°ã®æ¡ä»¶ã‚’è¿½åŠ  (è¦æœ›â‘  - è¤‡æ•°é¸æŠå¯¾å¿œ)
        if (checkedCups.length > 0) {
            // Lã‚«ãƒƒãƒ—ä»¥ä¸Š ("Lä»¥ä¸Š") ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
            const includesLOver = checkedCups.includes("Lä»¥ä¸Š");
            
            // é¸æŠã•ã‚ŒãŸä¸­ã§æœ€ã‚‚å°ã•ãªã‚«ãƒƒãƒ—æ•°ï¼ˆä¾‹: B, C, DãŒé¸æŠã•ã‚ŒãŸã‚‰ Bï¼‰ã‚’APIã«é€ã‚Šã¾ã™
            const sortedCups = checkedCups
                                .filter(c => c.length === 1) // Lä»¥ä¸Šã®æ–‡å­—åˆ—ã‚’é™¤å¤–
                                .sort(); 

            let minCupForAPI = sortedCups.length > 0 ? sortedCups[0] : null;

            if (minCupForAPI) {
                // FANZA APIã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ 'min_bust' (æŒ‡å®šã‚«ãƒƒãƒ—æ•°ä»¥ä¸Š) ã‚’ä½¿ã„ã¾ã™
                searchParams += `&min_bust=${minCupForAPI}`; 
            }
        }
        
        // 3. èº«é•·ã®æ¡ä»¶ã‚’è¿½åŠ 
        if (heightMin) {
            searchParams += `&min_height=${heightMin}`;
        }
        if (heightMax) {
            searchParams += `&max_height=${heightMax}`;
        }
        
        // æœ€çµ‚çš„ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆURL
        const requestUrl = `${API_ENDPOINT}?${keyParams}&${searchParams}`;

        // æ¤œç´¢çµæœã‚¨ãƒªã‚¢ã®è¡¨ç¤ºã‚’æ›´æ–°
        const resultDiv = document.querySelector('.actress-list');
        resultDiv.innerHTML = '<h2>æ¤œç´¢çµæœ</h2><p>ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­ã§ã™...</p>';

        // ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ï¼
        fetch(requestUrl)
          .then(response => response.json())
          .then(data => {
            console.log("APIã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿:", data); 

            let filteredItems = data.result.items || [];
            
            // ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µã‚¤ãƒˆã«è¡¨ç¤ºã™ã‚‹å‡¦ç†
            resultDiv.innerHTML = `<h2>æ¤œç´¢çµæœ (${filteredItems.length}ä»¶è¡¨ç¤º - æ‰¿èªå¾…ã¡)</h2>`;
            
            if (filteredItems.length > 0) {
                 filteredItems.forEach(item => {
                     const bustSize = item.sizes ? ` (B: ${item.sizes.bust})` : '';
                     resultDiv.innerHTML += `<div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 5px;">
                                                <p><strong>${item.title}</strong>${bustSize}</p>
                                                <p>APIæ‰¿èªå¾Œã€ã“ã“ã«è©³ç´°æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                                             </div>`;
                 });
            } else {
                resultDiv.innerHTML += `<p>è©²å½“ã™ã‚‹å¥³å„ªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>`;
            }
          })
          .catch(error => {
            console.error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            resultDiv.innerHTML = '<h2>ã‚¨ãƒ©ãƒ¼</h2><p>APIã‚­ãƒ¼ã®èªè¨¼ã«å¤±æ•—ã—ã¦ã„ã‚‹ã‹ã€FANZAã®æ‰¿èªå¾…ã¡ã§ã™ã€‚</p>';
          });
    }
    </script>
</body>
</html>
